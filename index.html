<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Image Quiz</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 20px; }
    img { width: 200px; height: auto; margin: 10px; cursor: pointer; }
    .question-title { font-size: 24px; margin-bottom: 20px; }
  </style>
</head>
<body>

  <div id="quiz-container">
    <div class="question-title" id="question-title"></div>
    <div id="image-options"></div>
  </div>

  <div id="results" style="display:none;"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
const questions = [
  {
    title: "teamwork",
    images: [
      "i-like-working-by-myself.png",
      "i-like-working-with-one-or-two-people.png",
      "i-like-working-with-a-big-group.png"
    ]
  },
  {
    title: "routines",
    images: [
      "i-like-doing-things-differently-each-day.png",
      "i-like-when-plans-can-change-a-little.png",
      "i-like-doing-things-the-same-every-day.png"
    ]
  },
  {
    title: "adapting-to-change",
    images: [
      "i-like-when-things-stay-the-same.png",
      "i-think-before-i-try-something-new.png",
      "i-feel-good-when-things-are-different.png"
    ]
  },
  {
    title: "handling-pressure",
    images: [
      "i-do-best-when-things-are-quiet-and-calm.png",
      "i-notice-whats-going-on-and-stay-calm.png",
      "i-stay-calm-and-help-others-when-things-are-busy.png"
    ]
  },
  {
    title: "paying-attention-to-details",
    images: [
      "i-think-about-the-big-idea.png",
      "i-notice-small-things-when-i-need-to.png",
      "i-notice-small-things-all-the-time.png"
    ]
  },
  {
    title: "finishing-tasks",
    images: [
      "i-ask-others-to-help-if-i-need-to.png",
      "i-keep-going-even-when-its-hard.png",
      "i-try-hard-to-finish-what-i-start.png"
    ]
  },
  {
    title: "taking-initiative",
    images: [
      "i-wait-for-clear-instructions.png",
      "i-think-before-i-act.png",
      "i-like-to-start-things-on-my-own.png"
    ]
  },
  {
    title: "solving-problems",
    images: [
      "i-ask-for-help-when-i-need-it.png",
      "i-like-to-solve-problems-with-others.png",
      "i-fix-problems-by-myself.png"
    ]
  },
  {
    title: "organizing-things",
    images: [
      "i-like-things-messy-or-in-my-own-way.png",
      "i-like-some-order-and-some-creativity.png",
      "i-like-everything-neat-and-organized.png"
    ]
  },
  {
    title: "creativity",
    images: [
      "i-like-to-do-things-the-usual-way.png",
      "i-like-to-try-new-ways-sometimes.png",
      "i-like-to-make-new-things-in-new-ways.png"
    ]
  },
  {
    title: "talking-and-listening",
    images: [
      "i-am-good-at-listening.png",
      "i-am-good-at-talking-with-one-person.png",
      "i-like-talking-with-groups-or-leading-a-group.png"
    ]
  },
  {
    title: "structure",
    images: [
      "i-like-to-decide-what-to-do.png",
      "i-like-to-have-some-rules.png",
      "i-like-when-rules-are-clear.png"
    ]
  },
  {
    title: "time-management",
    images: [
      "i-do-well-when-time-is-flexible.png",
      "i-think-about-how-i-use-my-time.png",
      "i-keep-good-track-of-time-and-deadlines.png"
    ]
  },
  {
    title: "learning",
    images: [
      "i-learn-best-by-doing-what-i-already-know.png",
      "i-like-to-think-about-what-ive-learned.png",
      "i-use-what-ive-learned-right-away.png"
    ]
  },
  {
    title: "trying-new-things",
    images: [
      "i-like-to-do-things-the-same-way.png",
      "i-sometimes-try-new-things.png",
      "i-love-trying-new-things.png"
    ]
  }
];

let current = 0;
const answers = [];

function showQuestion(index) {
  const question = questions[index];
  document.getElementById('question-title').textContent = question.title;

  const imageContainer = document.getElementById('image-options');
  imageContainer.innerHTML = '';

  question.images.forEach((src) => {
    const wrapper = document.createElement('div');
    wrapper.style.display = 'inline-block';
    wrapper.style.margin = '10px';

    const img = document.createElement('img');
    img.src = src;
    img.alt = src.replace(/-/g, ' ').replace(/\.png$/, '');

    const caption = document.createElement('div');
    caption.textContent = img.alt.charAt(0).toUpperCase() + img.alt.slice(1);
    caption.style.marginTop = '5px';

    img.onclick = () => {
      answers.push(`${question.title}: ${img.alt}`);
      current++;
      if (current < questions.length) {
        showQuestion(current);
      } else {
        showResults();
      }
    };

    wrapper.appendChild(img);
    wrapper.appendChild(caption);
    imageContainer.appendChild(wrapper);
  });
}
function downloadPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  const text = document.getElementById('results').dataset.content || 'No content';

  const lines = doc.splitTextToSize(text, 180);
  doc.text(lines, 10, 10);
  doc.save("cover_letter.pdf");
}


function showResults() {
  document.getElementById('quiz-container').style.display = 'none';
  const resultDiv = document.getElementById('results');
  resultDiv.style.display = 'block';
  resultDiv.textContent = 'Submitting...';

  fetch('https://api.tsl.rocks/coverletter?pass=NoSecret', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      preferences: answers,
      jobPrompt: "Please make this cover letter suitable for a variety of roles. Keep it under 300 words."
    })
  })
  .then(res => res.json())
.then(data => {
  const resultDiv = document.getElementById('results');
  resultDiv.innerHTML = ''; // Clear any previous content

  // Store content for PDF generation
  resultDiv.dataset.content = data.content || 'No response.';

  // Create download button
  const btn = document.createElement('button');
  btn.textContent = 'Download as PDF';
  btn.onclick = downloadPDF;
  resultDiv.appendChild(btn);
})
.catch(err => {
  const resultDiv = document.getElementById('results');
  resultDiv.textContent = 'Error: ' + err.message;
});

}


    // Start the quiz
    showQuestion(current);
  </script>

</body>
</html>
